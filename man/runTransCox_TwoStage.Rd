% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runTransCox_TwoStage.R
\name{runTransCox_TwoStage}
\alias{runTransCox_TwoStage}
\title{Two-Stage TransCox Algorithm with Post-Selection Refitting}
\usage{
runTransCox_TwoStage(
  primData,
  auxData,
  cov,
  statusvar,
  p_value_threshold = 0.05,
  lambda1 = NULL,
  lambda2 = NULL,
  lambda_beta = NULL,
  learning_rate = 0.001,
  nsteps = 5000,
  tolerance = 1e-07,
  parallel = FALSE,
  n_cores = NULL,
  verbose = FALSE,
  auto_tune = TRUE
)
}
\arguments{
\item{primData}{A data.frame containing the target domain data (primary data). Must contain time, status, and covariates.}

\item{auxData}{A data.frame containing the source domain data (auxiliary data).}

\item{cov}{A character vector of feature names to be included in the analysis.}

\item{statusvar}{A character string specifying the name of the status variable (event indicator).}

\item{p_value_threshold}{A numeric value specifying the P-value threshold for filtering variables
in the second stage (default is 0.05). Variables with P-values above this threshold are discarded.}

\item{lambda1}{Numeric. Penalty for Transfer (beta - beta_source). Scaled by 1/N_events.}

\item{lambda2}{Numeric. Penalty for Xi (Baseline Hazard deviation). Scaled by 1/N_events.}

\item{lambda_beta}{Numeric. Penalty for Global Sparsity (beta). Scaled by 1/N_events.}

\item{learning_rate}{Numeric. Step size for Proximal Gradient Descent. Default is 0.001.}

\item{nsteps}{Integer. Maximum number of optimization steps. Default is 5000.}

\item{tolerance}{Numeric. Convergence tolerance for the PGD algorithm. Default is 1e-7.}

\item{parallel}{Logical. Whether to run internal calculations in parallel (if applicable). Default is FALSE.}

\item{n_cores}{Integer. Number of cores for parallel processing. Default is NULL.}

\item{verbose}{Logical. If TRUE, prints progress messages to the console during execution.}

\item{auto_tune}{Logical. Whether to use BIC.}
}
\value{
A list containing the following components:
\item{new_beta}{The estimated coefficient vector (numeric vector of length P). These are unbiased estimates from the final refitted model.}
\item{new_IntH}{A data.frame containing the re-estimated baseline cumulative hazard with columns \code{time} and \code{cumQ_upd}.}
\item{stage1_vars}{A character vector of variables selected in the first screening stage (Stage 1).}
\item{final_vars}{A character vector of variables remaining after P-value filtering (Stage 2).}
\item{fit_obj}{The final \code{coxph} object from the second stage, useful for standard error and summary extraction.}
}
\description{
Implements a "Relaxed Lasso" or "Post-Lasso" strategy for high-dimensional survival analysis
with transfer learning.

The process consists of two main stages:
\enumerate{
\item Screening (Stage 1): Uses the TransCox algorithm (penalized transfer learning) with a
high-recall configuration to select a candidate set of active variables.
\item Refitting (Stage 2): Performs an unpenalized standard Cox Proportional Hazards regression
(CoxPH) on the selected subset. This step removes shrinkage bias and filters out false positives
based on statistical significance (P-value).
}
}
